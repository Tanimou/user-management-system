---
applyTo: '**'
---

<todos title="Run Vitest Tests for User Management API" agentRequirement="Review steps frequently throughout the conversation and DO NOT stop between steps unless they explicitly require it. Keep the todos updated using the todo_write tool (do not edit this file).">
- [x] setup-test-env: Set up test environment and check Vitest configuration ğŸ”´
  _Verified Vitest 3.2.4 is configured correctly with test scripts in package.json_
- [x] run-auth-tests: Run auth.test.ts to test password hashing, JWT tokens, and role authorization ğŸ”´
  _All 10 auth tests pass, including password hashing (576ms) and JWT functionality_
- [x] run-user-tests: Run users.test.ts and user-detail.test.ts to test user management endpoints ğŸ”´
  _Fixed mock request function to handle query parameters correctly. All 12 users tests and 17 user-detail tests now pass_
- [x] run-me-tests: Run me.test.ts to test user profile endpoints ğŸŸ¡
  _All 11 me.test.ts tests pass covering profile retrieval and updates_
- [x] fix-failing-tests: Identify and fix any failing tests or missing dependencies ğŸ”´
  _Fixed createMockRequest function in mocks.ts to properly handle query params vs cookies. Now supports both GET requests with query params and POST requests with cookies_
- [x] run-coverage-report: Generate test coverage report to see test completeness ğŸŸ¡
  _Generated coverage report showing good test coverage: API endpoints 80-100%, overall coverage shows critical paths well tested_
- [x] run-all-tests: Verify all tests pass including auth, users, user-detail, me, login, refresh, health, and token-blacklist ğŸ”´
  _All 85 tests now pass successfully. Fixed query parameter and cookie handling in test mocks to resolve refresh token test failures_
</todos>

<!-- Auto-generated todo section -->
<!-- Add your custom Copilot instructions below -->
